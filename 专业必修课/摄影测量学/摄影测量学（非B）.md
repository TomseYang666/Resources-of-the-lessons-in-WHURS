目录
解析摄影测量	3
一、绪论	3
二、单幅影像解析基础	4
2.1基本知识	4
2.2共线方程	5
2.3航摄像片的像点位移与比例尺	6
2.4影像内定向	7
2.5单像空间后方交会	7
三、双像立体测图	8
3.1人的立体视觉和立体观测	8
3.2相对定向	9
3.3核线几何	9
3.4立体像对空间前方交会	10
3.5单元模型的绝对定向	10
3.6光束法严密解	11
四、解析空中三角测量	11
4.1概述	11
4.2航带法空中三角测量	12
4.3独立模型法区域网空中三角测量	13
4.4光束法区域网空中三角测量	13
4.5系统误差补偿	14
4.6自检校光束法区域网平差	15
4.7摄影测量与非摄影测量值的联合平差	15
4.8GPS辅助空中三角测量	16
数字摄影测量	18
五、数字影像与特征提取	19
5.1数字影像采样与重采样	19
5.2点特征提取算法	20
5.3线特征提取算子	22
5.4定位算子	23
六、影像匹配基础理论与算法	24
6.1影像相关原理	24
6.2影像相关的谱分析	25
6.3数字影像匹配基本算法	26
6.4最小二乘匹配	28
6.5特征匹配	31
七、数字地面模型的建立与应用	34
7.1概述	34
7.2数字高程模型的数据获取及预处理	35
7.3数字高程模型的内插方法	37
7.4DEM的精度及存贮管理	38
7.5三角网数字地面模型	39
7.6数字地面模型的应用	42
八、数字微分纠正	44
8.1数字微分纠正的概念	44
8.2框幅式中心投影影像的数字微分纠正	45
8.3线性阵列扫描影像的数字微分纠正	45
8.4立体正射影像对的制作	47
九、数字测图（计算机辅助测图）	47

解析摄影测量
一、绪论
1.摄影测量学：从非接触成像系统，通过记录、量测、分析与表达等处理，获取地球及其环境和其他物体的几何、属性等可靠信息的工艺、科学与技术。
2.摄影测量分类：
（1）按距离远近：航天摄影测量，航空，地面，近景，显微
（2）按用途：地形，非地形
（3）按处理手段：模拟，解析，数字。
3.摄影测量特点： 
	对影像进行量测与解译等处理，无需接触物体本身获得被摄物体信息，因而较少受到周围环境与条件的限制。
	由二维影像重建三维目标
	面采集数据方式
	同时提取物体的几何与物理特性
4.摄影测量的任务：
	地形摄影测量：用于测绘各种比例尺的地形图及城镇、农业、林业、地质、交通、工程、资源与规划等部门需要的各种专题图，建立地形数据库，为地理信息系统提供三维基础数据。
	非地形摄影测量：用于工业，建筑，考古，医学，生物，体育，变形观测，事故调查，公安侦破，军事侦察等各方面。
5.发展趋势：
传感器平台的多样化，无人机发展。
从对控制点的高度依赖走向无需地面控制点的摄影测量作业模式。
新型传感器的发展有望取代传统的胶片型传感器。
摄影测量软件平台的并行化与智能化。多传感器的有效集成。
	影像数字化：用高精度影像数字化仪（扫描仪）将像片（负片或正片）转化为数字影像
6.量测模式：
（1）单像量测：特征提取与定位及交互量测、
（2）双像量测：影像匹配及交互立体量测
（3）多像量测：多影像间的匹配及交互多影像量测
7.发展三阶段：
（1）模拟摄影测量：利用光学/机械投影方法实现摄影过程的反转，用两个/多个投影器模拟摄影机摄影时的位置和姿态构成与实际地形表面成比例的几何模型，通过对该模型的量测得到地形图和各种专题图。    光学像片——光学机械测图仪器——人工建立立体模型——人工量测和解译、机械绘图——图解线画地图、像片影像地图。
（2）解析摄影测量：以电子计算机为主要手段，通过对摄影像片的量测和解析计算方法的交会方式来研究和确定被摄物体的形状、大小、位置、性质及其相互关系，并提供各种摄影测量产品的一门科学。     光学像片——解析测图仪器——计算机建立立体模型——人工量测和解译、自动校正——数字线划地图、数字高程模型、像片影像地图

（3）数字摄影测量：基于摄影测量的基本原理，通过对所获取的数字/数字化影像进行处理，自动（半自动）提取被摄对象用数字方式表达的几何与物理信息，从而获得各种形式的数字产品和目视化产品。   数字影像——数字测量摄影系统——自动建立立体模型——自动量测和解译、自动记录——数字线划地图、数字高程模型、数字影像地图、数据库

摄影测量三个发展阶段的特点：
发展阶段	原始资料	  投影方式	仪器	操作方式	产品
模拟摄影测量	像片	物理投影	模拟测图仪	手工操作	模拟产品
解析摄影测量	像片	数字投影	解析测图仪	机助作业员操作	模拟产品数字产品
数字摄影测量	数字化影像、数字影像	数字投影	计算机	自动化操作+作业员干预	数字产品模拟产品

8.当代摄影测量面对的问题
（1）当代数字摄影测量与解析摄影测量模拟摄影测量的根本差别之一在于对影像辐射信息的计算机数字化处理。不仅要快速确定目标点的三维坐标，还要自动确定目标点纹理。
（2）全数字摄影测量数据量大。数字摄影测量中量测与识别的任务量大且艰巨，需要快速算法。对影像进行量测是摄影测量的基本任务，因此保持精度是关键。
（3）自动化是当代数字摄影测量最突出的特点，是评价的指标。影像解译依托影像结构与纹理的分析，在实现自动化方面还有困难。

9.摄影测量相机的特点
单面阵航空数码相机无框标，不需内定向，把内定向参数设为恒等变换或平移变换。
多面阵航空数码相机：需要对数码相机指定相应的规范。
三线阵航空数码相机

二、单幅影像解析基础
2.1基本知识
1.航空摄影：利用安装在航摄飞机上的航摄仪从空中一定角度对地面进行摄影。
（1）航摄仪焦距：物镜节点到焦点的距离
（2）像片主距：物镜后节点到像片主点的垂距
（3）像场：物镜焦面上中央成像清晰的范围
（4）像场角：像场直径对物镜后节点的夹角
2.空中摄影的参数：
（1）空中摄影：用竖直摄影方式，即摄影瞬间摄影机物镜主光轴近似与地面垂直。
（2）摄影比例尺：把摄影像片当作水平像片，地面取平均高程，这时候像片上的线段l和地面上相应线段的水平距L之比。1/m=l/L=f/H
（3）航高：摄影机物镜相对于某一基准面的高度。
相对航高：摄影机物镜相对于某一基准面的高度，即摄影航高
绝对航高：相对于平均海平面的航高，摄影物镜在摄影瞬间的真实海拔高度。
（4）航向重叠：同一条航线内相邻影片之间的影像重叠称之为航向重叠
航向重叠度：重叠部分与整个像幅长的百分比称为重叠度。
（5）旁向重叠：两相邻航带像片之间也需要有一定的影像重叠。
旁向重叠度：重叠部分与整个幅宽的百分比称为重叠度。
（6）航带弯曲：把一条航线的航摄像片据地物影像拼接，各张像片的主点连线不在一条直线上，而呈现为弯弯曲曲的折线。
航带弯曲度：航带两端像片主点之间的直线距离L与偏离该直线最远的像主点到该直线垂距比的倒数。
（7）像片旋偏角：相邻两像片的主点连线与像幅沿航带飞行方向的两框标连线之间的夹角称为像片的旋偏角。

3.航空摄影的参数要求：
（1）像片倾角为2-3°
（2）航高的变化不超过5%，同一航带内最大航高与最小航高之差不得大于30m，摄影测量区域内实际航高与设计航高之差不得大于50m
（3）航向重叠度一般要求60%以上，旁向重叠度一般要求30%左右。在航向方向上必须要三张相邻像片有公共重叠影像，称之为三度重叠部分，其中1、3张像片的重叠部分不能太小。
（4）航带弯曲度一般规定不得超过3%
（5）航带旋偏角一般要求小于6°。

1. 投影方式：（1）中心投影：投影射线会聚于一点（2）平行投影：投影射线都平行与某一固定方向（3）斜投影：投影射线与投影平面斜交（4）正射投影：投影射线与投影平面正交
5.透视变换：将空间点、线作中心投影，在投影平面P上得到一一对应的点、线，这种经中心投影取得的一一对应的投影关系称为透视变换
透视变换的特性：（1）同素性：几何元素的种类不发生变化（2）互换性：像与物互为投影（3）结合性：直线的交点投影仍为直线的交点
2.2共线方程
1.摄影测量常用坐标系：
（1）像平面坐标系o-xy：（包括像主点坐标系和框标坐标系）影像平面内的直角坐标系，表示像点在像平面上的位置。原点为像主点。x和y轴与框标坐标系的方向相同。
（2）像空间坐标系S-xyz：过渡坐标系，用于表示像点在像方空间的位置。原点位于摄影中心S，z轴为摄像机的主光轴S_0，x轴和y轴分别与像平面坐标系的x，y轴平行。
（3）像空间辅助坐标系S-XYZ：过渡坐标系，原点位于S，Z轴为铅垂方向，航向方向为X轴，这样有利于改正沿航线方向累计的系统误差。
（4）摄影测量坐标系A-XpYpZp：过渡坐标系，地面上某点A为坐标原点，其他坐标轴和像空间辅助坐标系一致。
（5）物空间坐标系O-XtYtZt：地面测量坐标系（大地坐标系），左手坐标系，其余均右手坐标系。（平面为高斯克吕格3度带或6度带投影即1980西安坐标系，高程为1985黄海高程基准）
2.内方位元素：确定摄影机的镜头中心相对于影像位置关系的参数，包括f，x0，y0
3.外方位元素：确定影像或摄影光束在摄影瞬间的空间位置和姿态的参数。三个线方位元素：Xs，Ys，Zs，描述摄影中心S相对于物方空间坐标系的位置。三个角元素φ，ω，κ，用于描述影像面在摄影瞬间的空中姿态。
4.转角系统作用：恢复摄影光束在摄影时刻的空中姿态，单张像片的纠正。
5.正交变换：坐标系按三个角元素顺次绕坐标轴旋转即可变换为另一个同原点的坐标系。
6.正变换：大地测量坐标系转化成地面摄影测量坐标系的变换。
将地物点在大地测量坐标系中的模型坐标转化成地面摄影测量坐标，需控制点2平高+1高程

7.共线方程：表达了摄影中心，像点，对应物点在同一条直线的几何关系。
{█(x=-f (a_1 (X-X_S)+b_1 (Y-Y_S)+c_1 (Z-Z_S))/(a_2 (X-X_S)+b_2 (Y-Y_S)+c_2 (Z-Z_S))@y=-f (a_3 (X-X_S)+b_3 (Y-Y_S)+c_3 (Z-Z_S))/(a_2 (X-X_S)+b_2 (Y-Y_S)+c_2 (Z-Z_S)))┤
共线方程的应用：（1）单像空间后方交会和多像空间前方交会（2）解析空中三角测量光束法平差中的基本数学模型（3）构成数字投影的基础（4）计算模拟影像数据（5）用DEM与共线方程制作正射影像（6）用DEM与共线方程进行单幅影像测图
2.3航摄像片的像点位移与比例尺
1.地形图特点：（1）图上任两点间距离与相应地面点的水平距离之比为一常数，等于比例尺（2）图上任一点引画的两条方向线间的夹角等于地面上对应的水平角
2.地形图和航摄像片比较：（1）比例尺：地图有统一比例尺，航片无统一比例尺（2）表示方法：地图为线划图，航片为影像图（3）表示内容：地图需要综合取舍（4）几何差异：航摄像片可组成像对立体观察（5）航摄像片为中心投影，地形图为正射投影
3.像点位移：一地面点在地面水平的水平像片上的构像与地面有起伏时或倾斜像片上构像的点位不一样，这种差异称为像点位移。
4.方向偏差：从航摄像片上某点作出的方向线与地面对应点所画出的方向线的方位角不相等，这种差异称之为方向偏差。

摄影测量的主要任务之一就是把地面按中心投影规律获取的摄影比例尺航摄像片转换成以测图比例尺表示的正射投影地形
2.4影像内定向
1.影像内定向：传统摄影测量中，将影像架坐标变换为以影像上像主点为原点的像坐标系中的坐标；当代摄影测量中，将扫描坐标系转换到像坐标，都称为影像内定向。
2.内定向方法：借助影像的框标来解决，位于影像四边中央的为机械框标，位于影像四角的为光学框标。若用线性正形变换，仅需量测3个框标，若用放射变换公式，则需量测4个框标，若采用双线性变换公式和投影变换公式，则需量测8个框标。
3.解析内定向：用平面相似变换，将像片架坐标变换为以像主点为原点的框标坐标系坐标
解析内定向步骤：（1）获取框标点的理论坐标（2）用合适的变换模型（3）建立误差方程（4）建立法方程并解算（5）由变换参数计算像点坐标
2.5单像空间后方交会
1.单像空间后方交会：用影像覆盖范围内的控制点的空间坐标与影像坐标，据共线条件方程，反求该影像的外方位元素。
思想：以单幅影像为基础，从该影像所覆盖地面范围内控制点的已知地面坐标和相应点的像坐标量测值出发，据共线方程，解求该影像在航空摄影时刻的外方位元素。（需3个平高；分布合理；不在一条直线上；不在同一高度）
2.后方交会计算过程：（1）获取已知数据：摄影比例尺，航高，内方位元素，控制点的空间坐标（2）量测控制点的像点坐标并进行必要的影像坐标系统误差改正，得到像点坐标（3）确定未知数的初始值（4）计算旋转矩阵R（5）逐点计算像点坐标的近似值（6）逐点计算误差方程式的系数和常数项，组成误差方程式（7）计算法方程的系数矩阵ATA与常数项ATL，组成法方程式（8）解求外方位元素（9）检查计算是否收敛。若线元素和角元素ϕ，ω，κ的改正数小于限差，迭代结束，否则用新的近似值重复计算，直到满足要求为止。

三、双像立体测图
3.1人的立体视觉和立体观测
1. 人用双眼观察景物可判断其远近，得到景物的立体效应，这种现象称为人眼的立体视觉；观察立体像对得到地面景物立体影像的立体感觉称为人造立体视觉
2.单眼分辨力：单眼能够判别最小物体的能力
第一分辨力：用单眼所能观察出的两点间的最小距离。
第二分辨力：用单眼所能观察出的两平行线间的最小距离。
3.人造立体视觉：因远近不同而形成的交会角的差异，便在人的两眼中产生了生理视差，得到立体视觉。而通过观测立体像对得到地物景物立体影像的立体感觉称为人造立体视觉。
4.立体像对：由不同摄站获取的，具有一定影像重叠的两张像片。
5.观察人造立体的条件：（1）像对条件：立体像对，分别在左右两位置对同一物体拍摄的影像（2）分像条件：双眼必须保持分别只能对一张像片观察（3）平行条件：两影像上同名像点连线与眼基线大致平行（4）尺度条件：两影像的比例尺应接近（差别<15%）
6.用航摄像片进行立体观察的条件是：（1）从两个摄站对同一物体拍摄的立体像对（2）一只眼睛只看一张像片（3）眼基线与摄影基线大致平行
立体视模型：双眼观察立体像对所构成的立体模型
7.立体效应：
（1）正立体效应：将左方摄影站获得的像片P1放在左方，用左眼观察，右摄影站摄得的像片P2放在右方，用右眼观察，立体效果与实物相似
（2）反立体效应：左方摄影站获得的像片P1放在右方，用右眼观察，右摄影站摄得的像片P2放在左方，用左眼观察，由于生理视差改变了符号，观察到的立体影像的立体远近恰好与实物相反
（3）零立体效应：将正立体情况下的两张像片，在各自的平面内按同一方向旋转90°，使像片上纵横坐标互换了方向。像片上原来的纵坐标y轴转到与基线平行，生理视差变为像片的y方向的视差，因而失去了立体感。
8.像对的立体观察：（1）立体镜观察法（2）叠映影像立体观察法（3）双目镜观测光路的立体观察法：双筒望远镜观察，每个望远镜相平面有一固定测标，像片可在两个相互垂直方向上共同移动。可对左右影像自由调焦，亮度调节和旋转，观测放大倍率可调，提高效能。
9.立体镜观察法：（1）桥式立体镜：在一桥架上安置两个相同的简单透镜，两透镜光轴平行，间距约为眼间距，高度等于透镜焦距。结构简单，基线太短不能观察大像幅航摄相片（2）反光立体镜：在左右光路中个加一对反光镜。结构复杂。扩大眼间距，高程比例尺夸大，增强立体感，提高两侧精度
10.叠映影像立体观察法：（1）光闸法：两投影光路中安装一光闸，一个打开一个关闭，双眼带上与投影器光闸同步的闪闭眼镜，光亮度损失小，振动和噪声影响作业（2）偏振法：两投影光路安装两块偏振平面互成90°的起偏镜，左右偏振平面相互垂直（3）互补色法：在投影器中加入互补色滤光片。双眼分别带上同色镜片。可观察到白底灰色的地面立体模型，暗室作业劳动强度大。
11.像片系统误差源：摄影机的系统误差、底片变形、航摄飞机带来的系统误差、大气折光误差、地球曲率的影响、摄影处理与底片复制中的系统误差、观测系统误差
3.2相对定向
1.相对定向元素：描述立体像对两张像片相对位置和姿态关系的参数
2.立体相对定向：通过左右像片上同名像点位于同一核面的几何条件，恢复摄影时相邻两影像摄影光束的相互关系，使同名光线对对相交。（依据数学方程是共面条件方程，需5对同名点，完成的标志是上下视差q为0）
模型点上下视差：立体像对同名光线与立体模型表面相交，交点在y方向上的坐标差。
3.相对定向方法：（1）单独像对像对定向：用两幅影像的角元素运动实现相对定向，其定向元素为（φ1，κ1，φ2，ω2，κ2）（2）连续像相对定向：以左影像为基准，用右影像的直线运动和角运动实现相对定向，定向元素为（By，Bz，φ2，ω2，κ2）。多用（3）带模型连接条件的连续法相对定向元素：u，v，φ，ω，κ，λ
4.常数项几何意义：q为相当于像空间辅助坐标系中一对理想像对上同名像点的上下视差
当一个立体像对完成相对定向，q＝0。反之，立体像对未完成相对定向，即同名光线不相交。
5.相对定向元素计算：
（1）获取已知数据x0,y0,f
（2）确定相对定向元素的初值，都为0
（3）由相对定向元素计算像空间辅助坐标X1,Y1,Z1,X2,Y2,Z2
（4）计算误差方程式的系数和常数项
（5）解法方程，求相对定向元素改正数
（6）计算相对定向元素的新值
（7）判断迭代是否收敛
3.3核线几何
1.核面：过摄影基线S1S2与任一物方点A所作的平面Wa称为通过A的核面。通过像主点的核面称为主核面。
2.核线：立体像对中，同名光线与摄影基线所组成的核面与左右像片的交线
3.（1）摄影基线：相邻两摄站的连线（2）同名核线：核面与左右像片面的交线（3）同名像点：同名光线在左右像片上的构像（4）同名光线：同一地面点发出的两条光线（5）基高比：摄影基线与航高的比值（越大，高程定位精度越高）
4.（1）理想像对：相邻两像片水平、摄影基线水平的立体像对（2）正直像对：相邻两像片水平、摄影基线不水平的立体像对（3）竖直像对：相邻两像片不水平、摄影基线不水平的立体像对

3.4立体像对空间前方交会
1.立体像对空间前方交会：由立体像对中两张像片的内、外方位元素和像点坐标来确定相应地面点在物方空间坐标系中坐标的方法。
数学模型：（1）点投影系数的空间前方交会（2）共线方程严密解法：严格，不受影像数约束，不需要空间坐标的初值。
2.点投影系数法前方交会步骤：（1）获取已知数据 x0 , y0 , f , XS1, YS1, ZS1, j1, w1, k1, XS2, YS2, ZS2 , j2, w2, k2 （2）量测像点坐标 x1, y1, x2, y2 （3）由外方位线元素计算基线分量BX, BY, BZ （4）由外方位角元素计算像空间辅助坐标  X1, Y1, Z1 , X2, Y2, Z2 （5）计算点投影系数 N1 , N2（6）计算地面坐标 XA, YA, ZA 
N=(B_X Z_2-B_Z X_2)/(X_1 Z_2-Z_1 X_2 )
N'=(B_X Z_1-B_Z X_1)/(X_1 Z_2-Z_1 X_2 )
{█(X=X_S1+NX_1=X_S1+B_X+N^' X_2@Y=Y_S1+NY_1=Y_S1+B_Y+N^' Y_2=Y_S1+1/2 (NY_1+N^' Y_2+B_Y )@Z=Z_S1+NZ_1=Z_S1+B_Z+N^' Z_2 )┤
在这种情况下，只需量测像点坐标即可，但要注意后方交会控制点要求。

3.共线方程法前方交会步骤：（1）获取已知数据 x0 , y0 , f , XS1, YS1, ZS1, j1, w1, k1, XS2, YS2, ZS2 , j2, w2, k2 （2）量测像点坐标 x1, y1 ,x2, y2（3）给定地面坐标的初始值 XA0, YA0, ZA0 （4）形成误差方程  a11, a12, a13 , a21, a22, a23及常数项（5）建立法方程并求解地面坐标增量 DX, DY, DZ（6）计算地面坐标 XA, YA, ZA （7）判断迭代是否收敛
未知数：2*6(两张外方位元素)+6*3(6个待定点XYZ)=30
方程数：2*2*10=40(1个像点在左右像片列出2*2个方程)
此方法精度更高，初值由空间后方交会-前方交会法算出。

3.5单元模型的绝对定向
1.绝对定向元素：描述立体像对在摄影瞬间的绝对位置和姿态的参数，X0 ，Y0 ，Z0 ，， ，
2.绝对定向：通过将相对定向模型进行缩放、平移和旋转，使其达到绝对位置
3.绝对定向元素计算：（1）获取控制点的两套坐标Xp,Yp,Zp,Xtp,Ytp,Ztp（2）给定绝对定向元素的初值：三个角、线旋转参数为0，缩放参数为1（3）计算重心化坐标（4）计算误差方程式的系数和常数项（5）解法方程，求绝对定向元素改正数（6）计算绝对定向元素的新值（7）判断迭代是否收敛
4.重心化目的：（1）减少模型点坐标在计算过程中的有效位数，以保证计算的精度（2）使法方程的系数简化，个别项数值变为零，以提高计算速度
5.待定点加密的方法：（1）后方交会-前方交会解法：先用控制点的物方空间坐标与像坐标由单像空间后方交会求出左、右影像外方位元素，再据待定同名点的像点坐标与外方为元素，利用空间前方交会方法求出待定点的物方空间坐标。（2）相对定向-绝对定向解法：先通过解求立体像对的相对定向元素，按前方交会方法计算的到模型点的空间辅助坐标以后，再由绝对定向参数求得待定点的物方空间坐标。（3）光束法严密解法：先分别求出两幅影像的外方位元素然后再作前方交会，再将参数与物方空间点坐标在一个整体内进行，理论较为严密。
3.6光束法严密解
1.光束法：有左、右两幅影像的12个外方位元素未知数，对每一个待定点则引入三个空间坐标未知数。每一对同名点可列出4个误差方程式，因此至少需要3个控制点才能确定平差的基准。设在一个立体像对中含有4个控制点，n个待定点，则需解求（12+3n）个未知数，而误差方程式个数为（16+4n）。

2.三种解法比较：（1）前后：前交的结果依赖于空间后方交会的精度，前交过程中没有充分利用多余条件进行平差计算。应用于已知影像的外方位元素、需确定少量的待定点坐标时采用。需3个平高，且前方交会求取地面点坐标精度取决于后方交会所解算的外方位元素的精度。（2）内外：最后的点位精度取决于相对定向和绝对定向的精度，用这种方法的解算结果不能严格表达一幅影像的外方为元素；2个平高+1个高程。在航带法解析空中三角测量中应用（3）光束：理论最严密、精度最高，待定点的坐标是完全按最小二乘法原理解求出来的。2个平高+1个高程。该方法在光线束法解析空中三角测量中应用。
四、解析空中三角测量
空中三角测量的目的在于一步求出待求点坐标，同时完成影像定向和影像测图，防止累计误差。
4.1概述
1.解析空中三角测量：据航摄像片上所量测的像点坐标和必要的用以确定平差基准的非摄影测量信息测定所摄目标地区未知点的物方空间坐标。
解析空中三角测量指的是用摄影测量解析法确定区域内所有影像的外方位元素。根据影像上量测的像点坐标及少量控制点的大地坐标，求出未知点的大地坐标，使得已知点增加到每个模型中不少于四个，然后利用这些已知点求解影像的外方位元素，因而解析空中三角测量也称摄影测量加密。

分类：（1）按数学模型：航带法、独立模型法、光束法。（2）平差范围大小：单模型法、单航带法和区域网法。
2.模型连接构造自由航带网三种方法：带模型连接条件的连续法相对定向，归化系数法，三维空间相似变换。

3.解析的意义：（1）不触及被量测目标即可测定其位置和几何形状（2）可快速地在大范围内同时进行点位测定，以节省野外测量工作量（3）不受通视条件限制（4）摄影测量平差是，区域内部精度均匀，且不受区域大小限制。
4.目的：（1）为测绘地形图提供定向控制点和像片定向参数（2）测定大范围内界址点的统一坐标（3）单元模型中大量地面点坐标的计算（4）解析近景摄影测量和非地形摄影测量
5.应用：（1）为4D产品生产提供定向控制点和影像定向参数（2）进行三、四等或等外三角测量的点位测定（3）测定大范围内界址点的统一坐标，即用于地籍测量（4）单元模型中大量地面点坐标的计算（5）解析近景摄影测量和非地形摄影测量。
6.解析空中三角测量所必需的信息：（1）摄影测量信息：像片上量测的控制点、定向点、连接点及待求点等等的像点坐标，或在建立的立体模型上量测的上述各类点的模型坐标。（2）非摄影测量信息：指将空中三角测量网纳入到规定物方坐标系所必须的基准信息。从联合平差意义上讲，还包括直接的大地测量观测值、导航数据所提供的影像外方位元素以及物方点之间存在的相对控制条件等。
7.影像连接点类型：人工转刺点，仪器转刺点，标志点，明显地物点，数字影像匹配转点
8.航摄像片系统误差，像点坐标系统误差：（1）摄影材料的变形：内定向矫正（2）摄影物镜畸变：物镜畸变差改正系数改正（3）大气折光：用不同高度的大气折射率改正（4）地球曲率：在物方空间或像方空间改正
4.2航带法空中三角测量
1.航带法空中三角测量：通过相对定向和模型连接先建立自由航带法、以点在该航带中的摄影测量坐标为观测值，通过非线性多项式中变换参数的确定，使自由网纳入所要求的地面坐标系，并使公共点上不符值的平方和为最小。
2.主要思想：把许多立体像对构成的单个模型连结成航带模型，将航带模型视为单元模型进行解析处理，通过消除航带模型中累积的系统误差，将航带模型整体纳入到测图坐标系中，从而确定加密点的地面坐标。
3.工作流程：（1）像点坐标的量测和系统误差预改正（2）立体像对的相对定向（3）模型连接构建自由航带网（4）航带模型的绝对定向（5）航带模型的非线性改正：一次多项式，二次正形变换多项式（6）加密点坐标计算
4.不足：在构建自由航带时，以前一步计算结果作为下一步计算的依据，所以误差累积得快，甚至偶然误差也会产生二次和的累积作用。
5.航带法区域网平差：基本思想：（1）按照单航带法构成自由航带网（2）用本航带的控制点及与上一航带的公共点进行三维空间相似变换，将整区各航线纳入统一的坐标系中（3）同时解求各航带非线性变形改正系数（4）计算各加密点坐标
4.3独立模型法区域网空中三角测量
1.独立模型法区域网空中三角测量：先通过相对定向建立起单元模型，以模型点坐标为观测值，通过单元模型在空间的相似变换，使之纳入到规定的地面坐标系，并使模型连接点上残差的平方和为最小。
2.基本思想：把一个单元模型视为刚体，利用各单元模型彼此间的公共点连成一个区域，每个单元模型只能作平移、缩放、旋转，这样的要求只有通过单元模型的三维线性变换完成。变换过程中要使模型间公共点的坐标尽可能一致，控制点的摄测坐标应与其地面摄测坐标尽可能一致，观测值改正数的平方和为最小，在满足这些条件的情况下，按最小二乘法原理求得待定点的地面摄测坐标。
3.基本步骤：（1）求出各单元模型中模型点的坐标，包括摄站点坐标（2）用相邻模型之间的公共点和所在模型中的控制点，对每个模型各自进行空间相似变换，列出误差方程式及法方程式（3）建立全区域的改化法方程式，并按循环分块法求解，求得每个模型的7个参数（4）由已经求得的每个模型的7个参数，计算每个模型中待定点的坐标。若为相邻模型的公共点，则取其平均值作为最后结果。
4.4光束法区域网空中三角测量
1.基本思想：以一张像片组成的一束光线作为一个平差单元，以中心投影的共线方程作为平差的基础方程，通过各光线束在空间的旋转和平移，使像片之间的公共光线实现最佳的交会，将整个区域最佳地纳入到控制点坐标系中，从而确定加密点的地面坐标和像片的外方位元素。
2.作业流程：（1）获取像片内方位元素、像点坐标和地面控制点坐标（2）确定像片外方位元素和加密点地面坐标的近视值（可利用航带法获得）（3）逐点建立误差方程式并法化（4）建立改化法方程式5）采用循环分块法求解改化法方程（6）求出每张像片的外方位元素（7）计算加密点的三维空间坐标
3.带状法方程系数矩阵带宽：矩阵的主对角线元素沿某行(列)到最远非零元素间所包含未知数个数
4.改化法方程：用矩阵运算消除法方程中一类或几类未知数而保留某一类未知数的法方程
5.三种区域网平差方法的比较：（1）数学模型：航：航带坐标的非线性多项式改正公式。独：单元模型空间相似变换公式。光：共线条件方程式（2）观测值：航：自由航带中各点的摄影测量坐标。独：计算的或量测的模型坐标。光：每幅影像的像点坐标（3）平差单元：航：航带。独：独立模型。光：单个光束（3）严密性：航：不严密。独：较严密（如果能顾及模型坐标之间的相关特性，该方法就与光束法一样严密）。光：严密（4）精度：航：低。独：较高（均为真正观测值的函数）。光：高（因为使用的观测值是真正的观测值），但若光束法的系统误差没有得到很好的补偿，则三种方法的精度也就没有显著的差异（5）速度：快，较快，慢（6）未知数个数：少，较多，多（7）是否需要未知数初始值：航：不需要。独：不需要。光：需要（由于共线方程所描述的像点坐标与各未知参数的关系是非线性的，因此必须建立误差方程式和提供各未知数初始值）（8）是否可以平面高程分开处理：航，独：可以。光：不可以，只能是三维网平差（9）应用：航：为严密平差提供初始值和小比例尺低精度点位加密。光：高精度的解析空中三角测量，点位测定

4.5系统误差补偿
1.可靠性：（1）内部可靠性：从理论上研究平差系统可发现、区分不同模型误差的能力（2）外部可靠性：从理论上研究不可发现的模型误差对平差结果的影响。
2.可靠性矩阵QvvP是降秩矩阵，描述观测值的可靠性，秩等于平差系统多余观测数，第i个对角线元素称第i个观测值的多余观测分量，范围是[0,1]。
Qxx为精度矩阵：评定平差的理论精度
3.接受域与拒绝域：当标准化残差wi落入接受域，接受原假设。当标准化残差wi落入拒绝域，拒绝原假设
4.粗差：是人为等因素引起的误差，具有偶然性，但在数值上比偶然误差大得多。
5.粗差检测方法：（1）将粗差视为函数模型的一部分（2）将粗差视为随机模型的一部分（3）从改正数绝对值总和最小出发的线性规划法。前两种都属于最小二乘法。
6.统计检验方法：将含粗差观测值视为与其他观测值具有相同方差、不同期望的正态母体之子样。通过最小二乘平差求出观测值残差的统计量，在给定的显著性水平进行假设检验，以判断观测值是否包含粗差
7.选权迭代法：将粗差视为来自期望为零、方差很大的正态母体之子样。通过最小二乘平差的验后方差估计求出观测值的验后方差，根据经典的权与观测值的方差成反比的定义给予它一个相应小的权进行下步迭代平差，以实现粗差定位。
8.解析摄影测量精度评定方法：（1）理论精度：从理论上进行分析，把待定点的坐标改正数视为随机变量，在最小二乘平差计算中，求出坐标改正数的方差—协方差矩阵。（2）实际精度：用大量野外实测控制点作为多余检查点，将平差计算所得该点坐标与野外实测坐标比较，其差值视为真误差，由这些真误差计算出点位坐标精度。
9.区域网平差的精度分布规律：区域网空中三角测量的精度最弱点位于区域的四周，而不在区域的中央。因此，平面控制点应当布设在区域的四周，才能起到控制精度的作用。当控制点稀疏分布时，区域网的理论精度会随着区域的增大而降低，但若增大旁向重叠，则可以提高区域网平差坐标的理论精度。高程理论精度取决于控制点间的跨度而与区域大小无关。

10.三种方法的精度分析：当密集周边布点时，区域网的理论精度对与航带法而言小于一条航带的测点精度；对于独立模型而言相当于一个单元模型的测点精度；而光束法区域网的理论精度不随区域大小而改变，是一个常数；
11.解析空中三角测量控制点布设的原则：（1）平面控制点应采用周边布点（2）高程控制点应布成锁形（3）信噪比较大时，光束法区域网平差可用附加参数的自检校平差来补偿影像系统误差（4）区域网平差中可用来代替地面控制点的非摄影测量观测值主要是导航数据，如GPS定位系统提供的摄站坐标（5）为提高区域网可靠性，控制点可布成点组（6）不增加控制点的情况下，扩大平差区域范围，可提高加密精度和可靠性。

12.系统误差：由于某种物理原因造成的有一定规律而不可避免的误差。来源：（1）摄影机的系统误差，如物镜畸变差、软片压平误差（2）不同的暗匣带来不同的系统误差（3）摄影飞机带来的系统误差（4）底片变形（5）大气折光（6）地球曲率（7）观测设备及观测员本身的系统误差。
13.补偿系统误差的方法：（1）试验场检校法：直接补偿法，由大量地面控制点求得补偿系统误差的参数，在保证摄影测量条件不变的情况下，用这组参数来补偿和改正实际区域网平差中的系统误差。（2）验后补偿法：不改变原来的平差程序，而通过对平差后残差大小及方向的分析推算影像系统误差的大小及特征。在观测值上引入系统误差改正。用改正后的影像坐标重新计算，改善平差结果（3）自检校法：见下面（4）自抵消法：对同一测区进行相互垂直的两次航摄飞行，航向与旁向重叠均为60%，获得同一测区的四组摄影测量数据。将这四组数据同时进行区域网平差，此时各组数据之间的系统变形将会相互抵消或减弱，使系统误差成了“偶然误差”。
4.6自检校光束法区域网平差
自检校光束法区域网平差：将若干附加参数的构成系统误差模型与光束法区域网平差模型组成基础误差方程，在解求影像定向参数与加密点坐标未知数的同时解求这些附加参数，从而在平差过程中自检定和消除系统误差的摄影测量区域网平差方法。
4.7摄影测量与非摄影测量值的联合平差
联合平差：将原始的大地测量观测值、一般的控制信息和相对控制条件与摄影测量观测值一起进行区域网平差，以取代地面控制点。
4.8GPS辅助空中三角测量
1.GPS辅助空中三角测量：利用安装在航摄飞机上与航摄仪相连的GPS接收机连续观测GPS卫星信号、获取航空摄影瞬间航摄仪快门开启脉冲，经GPS载波相位测量定位技术的离线数据后处理获取航摄仪曝光时刻摄站的三维坐标，将其视为带权观测值引入摄影测量区域网平差中，经采用统一的数学模型整体确定并对其质量进行评定。
2.目的：大量减少甚至完全消除地面控制点，以节省野外控制测量工作量、缩短航测成图周期、降低生产成本、提高生产效率
3.作业过程：（1）现行航空摄影系统改造及偏心测定（2）带GPS信号接收机的航空摄影，获取GPS载波相位观测量和航摄仪曝光时刻（3）解求GPS摄站坐标（4）GPS摄站坐标与摄影测量数据的联合平差，以确定目标点位并评定其质量
4.误差方程：在自检校光束法区域网平差基础上顾及投影中心与机载GPS天线相位中心几何关系所得到的一个基础方程
法方程：镶边带状矩阵,但边宽加大了,而其良好稀疏带状结构并没有破坏。因此可用传统的边法化边消元的循环分块解法求解
5.在线空中三角测量：用计算机的高速运算和联机操作控制的优点，把像点坐标的量测与最小二乘平差计算放在同一个环节中进行，一边观测，一边运算。
6.自动空中三角测量：用模式识别和多像影像匹配等方法代替人工在影像上自动选点与转点，自动获取像点坐标，提供给区域网平差程序解算，以确定加密点在选定坐标系中的空间位置和影像的定向参数。
7.自动的作业过程：（1）构建区域网（2）自动内定向（3）自动选点与自动相对定向（4）多影像匹配自动转点（5）控制点的半自动量测（6）摄影测量区域网平差
8.POS辅助全自动空中三角测量：将POS（GPS/IMU）数据视为带权观测值引入摄影测量区域网平差，经统一的数学模型解算地面目标点坐标和像片方位元素，并对其质量进行评定的理论、技术和方法。
9.POS系统：用安装于飞机上与航摄仪相连接的POS系统连续观测GPS卫星信号、同时测定航空摄影瞬间航摄仪的位置和姿态，经GPS载波相位测量动态定位技术的离线数据后处理获取航摄仪曝光时刻摄站的三维坐标及影像的姿态角，将其视为带权观测值引入光束法区域网平差中，用统一的数学模型确定地面目标点为和像片外方位元素，并对其质量进行评定的理论、技术和方法。
10.POS系统组成：（1）惯性测量装置（IMU）（2）GPS接收机：GPS系统由一系列GPS导航卫星和GPS接收机组成。采用载波相位差分的GPS动态定位技术解求GPS天线相位中心位置。（3）计算机系统（PCS）（4）数据后处理软件
11.POS系统与航空摄影系统的集成方法：（1）将POS系统和航摄仪集成在一起，通过GPS载波相位差分定位获取航摄仪的位置参数及惯性测量单元IMU测定航摄仪的姿态参数，可直接获得每张像片的外方位元素，能大大减少乃至无需地面控制直接进行航空影像的空间地理定位。（2）直接对地定位系统由惯性测量装置、航摄仪、机载GPS接收机和地面基准站GPS接收机4部分构成，需保证在航空摄影过程中前三者间的相对位置关系不变。（3）航摄仪、GPS天线和IMU三者之间的空间坐标变换可通过坐标变换实现。
12.POS数据进行直接传感器定向：在已知GPS天线相位中心、IMU及航摄仪三者之间空间关系的前提下，直接对POS系统获取的GPS天线相位中心的空间坐标及IMU系统获取的侧滚角、俯仰角、航偏角处理，获取航空影像曝光瞬间的摄站中心三维空间坐标及其航摄仪三个姿态角，在无地面控制条件下恢复航空摄影。优：不需进行空中三角测量、不需地面控制点。缺：缺少了多余观测，结果可靠性不强。对几何模型考虑简单，能达到的精度难以满足大比例尺测图（除需测定GPS天线相位中心与相机投影中心三个偏心分量（GPS相位中心与相机投影中心位置偏移）外，还需对IMU于相机坐标轴间的视准轴误差（IMU坐标轴与相机坐标轴旋转偏角）进行校正）
13.POS数据进行集成传感器定向：当GPS、IMU与航摄仪三者之间的空间关系位置时，要有适当数量的地面控制点，通过将DGPS/IMU系统获取的三维空间坐标与3个姿态数据作为空三的附加观测值参与区域网平差，而高精度获取每张航片的外方位元素，可大幅度减少地面控制点数量。优：容错能力强，定向结果精确。不需预先的系统校正，大大减少控制点数目。缺：需进行空中三角测量和加密点量测。
14.POS系统对地定位的主要误差源：
（1）传感器位置：传感器的放置要符合：<1>使检校误差对传感器间偏移改正的影响最小<2>传感器之间不能有任何微小移动
（2）时间同步：很难实现实时的DGPS/IMU组合导航系统。最跟本的问题是很难做到同步使用GPS和IMU数据
校正步骤：（1）初始校正：确定惯性系统从本体系转换到当地面水平系的旋转矩阵。两个阶段：粗校正和精确校正。粗校正是用传感器的原始输出数据和只考虑地球旋转及重力场假设模型估计姿态参数。精确校正是考虑到低精度的惯性系统不能在静态环境中校正，引入飞机运动来获取更高的对准精度
（2）系统检校：直接传感器定向先应布设理想的检校场，进行严格的系统检校，保证测定的定向参数有很高的精度。集成传感器定向无须布设检校场，但需根据测图精度要求，在全区布设一定数量地面控制点，进行像点坐标量测和空三解算，才能获得摄影瞬间像片的外方位元素。
15.POS航空摄影测量流程
（1）先由POS系统得到像片的6个外方位元素。当地面没有控制点时，直接用前方交会获得地面点坐标，当有控制点时，先用共线方程对POS系统获得的外方位元素检校，消除系统误差，再用前方交会。（2）量测像点坐标x1,y1,x2,y2（2）根据外方位元素计算基线分量Bx，By，Bz（3）根据POS提供的外方位元素角元素计算像空间辅助坐标X1，Y1，Z1，X2，Y2，Z2（4）计算点投影系数N1，N2（5）得到地面点的三维坐标Xa，Ya，Za（同点投影系数法）
16.恢复影像空中姿态方法：单片空间后方交会，先相对定向再绝对定向，POS系统直接获取外方位元素
17.PQS实验与结论

数字摄影测量
1.像点量测
•通过量测像点解决定向问题；
•通过量测像点解决目标点的位置、大小的确定；
方式：
•单张像片量测；
•基于立体像对的像点量测；
− 未知立体像对的定向参数；
− 已知立体像对的定向参数；

2.立体量测
立体量测可借助立体观察装置与测量的测标和量测计量工具来进行。我们在两张已安置好的像对上，眼睛可清晰地观察到立体，在两张像片上放置两个相同的标志作为测标。
• 借助两测标在x，y方向的共同移动，使得其中的左测标对准左像片上某一像点a；然后保持左测标不动，使右测标在x，y方向作相对移动，达到对准右像片上的同名像点a’。这样，在立体观察下，能看出一个空间的测标切于立体模型A点上，如图所示。
• 同名像点的x坐标之差x1-x2和y坐标之差y1-y2分别称为左右视差和上下视差，分别用p，q表示
3.数字摄影测量软件作业流程 
	定向参数的计算，包括内定向、相对定向、绝对定向
	空中三角测量
	形成核线排列的立体影像
	沿核线进行影像相关或特征匹配，并进行匹配编辑和匹配后的编辑
	建立数字高程模型
	自动绘制等高线
	制作正射影像
	等高线与正射影像叠加，制作等高线的正射影像图
	制作透视图与景观图
	数字影像的机助测量
	地图编辑与标注
五、数字影像与特征提取
意义：特征提取是影像分析和影像匹配的基础，也是单幅影像处理最重要的任务。特征提取主要是应用各种算子来进行的。
5.1数字影像采样与重采样
1.数字影像：灰度矩阵，每个元素为一个灰度值，对应着光学影像或实体的一个微小区域，称为像元或像元素。
特点：像元空间坐标和灰度值离散化，便于计算机进行处理，便于高密度存储管理，提高资料的存取速度。
在摄影测量中可以分为数字影像与数字化影像。（数字影像是由传感器直接获取的影像；数字化影像则是由模拟相片经数字化处理后获得的数字影像。）
2. 数字影像的频域表达有什么用处？ 
答：
1）在空间域，表达的主要是像点不同位置(x,y)处（或用(i,j)表达）的灰度值，而在频率域，则表达在不同频率中（像片上每毫米的线对数，即周期数）的振幅谱（傅立叶谱）。
2）变换后矩阵中元素的数目与原像中的相同，但其中许多是零值或数值很小，这就意味着通过变换，数据可以被压缩，使其能更有效地存储和传递。
3）其次是影像分解的分析以及许多影像处理过程，例如滤波、卷积以及在有些情况下的相关运算，在频域内可以更为有利地进行。其中所利用的一条重要关系，就是在空间域内的一个卷积相当于在频率域内其卷积函数的相乘，反之亦然。
4）在摄影测量中所使用的影像的傅立叶谱可以有很大的变化。例如在任何一张航摄影像上总可找到有些地方只包含有很低的频率信息，而有些地方则主要包含高频信息偶然地有些地区主要是有一个狭窄范围的带频率信息。

3.重采样：当欲知不位于矩阵（采样）点上的原始函数g(x,y)的数值时就需要进行内插，此时称为重采样。
采样：对实际连续函数模型离散化的量测过程。
量化：是把采样点上的灰度值转换成为某一种等距的灰度级。
编码：将离散幅值经过量化以后变为二进制数字的过程。
采样定理：∆x≤1/(2*f_l )  f_l为截止频率 按此公式采样则可以完全恢复g(x)，否则会有混淆现象。
方法：
(1)双线性内插法
卷积核为三角形函数W(x)=1-(x)
(2)双三次卷积法
卷积核为三次样条函数
(3)最近邻元法
直接取与P(x,y)点位置最近像元N的灰度值为该点灰度的采样值
三种方法的优缺点：最邻近像元法最简单，计算速度快且能不破坏原始影像的灰度信息，但其几何精度较差，最大可达 0.5像元，且可能会使图像不连续。双线性内插法克服了最近邻法使图像不连续的缺点，计算较三次卷积内插法简单，不足的是图像边缘受到平滑作用，会出现轮廓模糊现象。三次卷积内插法会使图像边缘增强，但是计算量太大，比较适合高精度的影像处理要求。
4.核线的重排列
重叠影像上的同名像点必定位于同名核线上。
（1）基于数字影像几何纠正的核线解析关系
算法思想：核线在航空影像上是相互不平行的，它们交于一个点——核点。若将影像上的核线投影（纠正）到一对“相对水平”——平行于摄影基线的影像对上后，则核线相互平行。（水平影像中所有核线平行于摄影基线，彼此之间也自然相互平行）
对于左影像，
{█(x=-f (a_1 u+b_1 v-c_1 f)/(a_3 u+b_3 v-c_3 f)@y=-f (a_2 u+b_2 v-c_2 f)/(a_3 u+b_3 v-c_3 f))┤
v=c带入可化简为：
{█(x=(d_1 u+d_2)/(d_3 u+1)@y=(e_1 u+e_2)/(e_3 u+1))┤
最后，以等间隔取一系列u值，可以得到一系列的像点坐标，重采样直接赋值给“水平”影像上对应的像点即可。
右影像同理。
该方法实质是一个数字纠正，将倾斜影像上的核线投影到“水平”影像对上，求得“水平”影像对上的同名核线
（2）基于共面方程的影像几何纠正关系
直接从核线的定义出发，不通过“水平”影像做媒介，直接在倾斜影像上获取同名核线，其本质为在左右影像上利用相对定向的方法确定在核线上的点。
5.2点特征提取算法
点特征主要指明显点，如角点、圆点等。提取点特征的算子称为兴趣算子或有利算子，即运用某种算法从影像中提取我们所感兴趣的即有利于某种目的的点。
1.Moravec算子
步骤：
1）计算各像元的兴趣值IV（Interest Value）。在以像素(c, r)为中心点的w*w的影像窗口，计算四个方向相邻像素灰度差的平方和，取其中最小者作为该点的兴趣值。
2）给定一定的阈值，将兴趣值大于该阈值的点（即兴趣值计算窗口的中心点）作为候选点。阈值的选择应以候选点中包括所需要的特征点而又不含过多的非特征点为原则。
3）选取候选点中的极值点作为特征点。在一定大小的窗口内（可不同于兴趣值计算窗口），将候选点中兴趣值不是最大者均去掉，仅留下一个兴趣值最大者，该像素即为一个特征点。
综上，Moravec算子是在四个主要方向上，选择具有最大-最小灰度方差的点作为特征点。
优点：算法简单，计算较快
缺点：所提取特征点与人的视觉往往不一致，有一些微小的偏差。

2.Forstner算子
该算子通过计算各像素的Robert梯度和像素(c, r)为中心的一个窗口的灰度协方差矩阵，在影像中寻找具有尽可能小而接近圆的误差椭圆的点作为特征点。
步骤：
1）计算各像素的Robert梯度。
2）计算l*l窗口中灰度的协方差矩阵。
3）计算兴趣值q与w
{█(w=1/trQ=DetN/trN@q=4DetN/(trN)^2 )┤
q即像素(c,r)对应的误差椭圆的圆度。若q为零，则表明该点可能在边缘上，若q为1，则表明为一个圆。
4）确定待选点。如果兴趣值大于给定的阈值，则该像点为待选点。阈值为经验值。
5）选取极值点。以权值w为依据选择极值点，即在一个适当窗口中选择最大的待选点，而去掉其余的点。
由于该算子较复杂，可首先用一简单的差分算子提取初选点，然后采用Forstner算子在3×3窗口计算兴趣值，并选择备选点最后提取的极值点为特征点。可以区分圆点和角点。

3.Harris角点提取算法
受信号处理中自相关函数的启发，给出与自相关函数相联系的矩阵M。M阵的特征值是自相关的一阶曲率，如果两个曲率值都很高，那么就认为该点是角点特征。
步骤：
1)首先确定 一个n×n大小的影像窗口，对窗口内的每一个像素点进行一阶差分运算，求得在x，y方向的梯度g_x,g_y；
2)对梯度值进行高斯滤波，高斯卷积模板的σ取0.3~0.9；
3)根据公式，计算强度值M；
4)选取局部极值点，在窗口内取最大值。局部极值点的数目往往很多，也可以根据特征点数提取的数目要求，对所有的极值点排序，根据要求选出兴趣值最大的若干个点作为最后的结果。
优点：
（1）Harris角点给出兴趣值作为衡量角点显著性，可以控制角点提取的输出。在一块区域内，可以按照兴趣值大小输出所需要的角点数目。有些情况下，需要特征点分布均匀，则可以通过格网内最大值抑制实现均匀角点的输出。
（2）计算较为简单。Harris算子中只用到灰度的一阶差分，操作简单。
（3）提取的点特征均匀而且合理。Harris算子对图像中的每个点都计算其兴趣值，然后在邻域中选择最优点。实验表明，在纹理信息丰富的区域，Harris算子可以提取出大量有用的特征点，而在纹理信息少的区域，提取的特征点则较少。
（4）即使存在有图像的旋转、灰度的变化、噪音影响和视点的变换，它也是最稳定的一种点特征提取算法
缺点：阈值难以判断；对尺度变化敏感；定位有偏差，只能达到像素级；检测速度较慢。

三种算子的比较：Moravec算子较简单，Forstner算子较复杂，但它能给出特征点的类型且精度也较高。Harris算子复杂程度介于两者之间,在实际处理过程中是很受欢迎的算子之一。
5.3线特征提取算子
线特征是指影像的“边缘"与“线”。
“边缘”可定义为影像局部区域特征不相同的那些区域间的分界线，
“线”则可以认为是具有很小宽度的其中间区域具有相同的影像特征的边缘对，也就是距离很小的一对边缘构成一条线，因此线特征提取算子通常也称边缘检测算子。
边缘的剖面灰度曲线通常是一条刀刃曲线，由于噪声的影响，灰度曲线并不是平滑的。对这种边缘进行检测，通常是检测一阶导数(或差分)最大或二阶导数
(或差分)为零的点。
常用方法有差分算子、拉普拉斯算子、LOG算子等。
由于各种差分算子均对噪声较敏感（即提取的特征并非真正的特征，而是噪声），因此一般应先作低通滤波，尽量排除噪声的影响，再利用差分算子提取边缘。LOG算子就是这种将低通滤波与边缘提取综合考虑的算子。
1.微分算子
梯度算子、Roberts梯度算子、Sobel算子（鲁棒）
2.二阶差分算子
方向二阶差分算子、Laplace算子、LOG算子（高斯函数低通滤波+Laplace算子）
3.特征分割法
特征参数：三个特征点的像素号、两个突出点的灰度差
利用三个特征点划分影像段，进而提取特征
4.Hough变换
基本原理：将影像空间中的曲线（包括直线）变换到参数空间中，通过检测参数空间中的极值点，确定出该曲线的描述参数，从而提取影像中的规则曲线。

步骤：
•对影像进行预处理提取特征并计算其梯度方向.
•将(θ,ρ)参数平面量化，设置二维累计矩阵H(θ_i,ρ_j).
•边缘细化，即在边缘点的梯度方向上保留极值点而剔除那些非极值点.
•对每一边缘点，以其梯度方向ψ为中心，设置一小区间[ψ-θ_0,ψ+θ_0].
•对累计矩阵进行阈值检测，将大于阈值的点作为备选点
•取累计矩阵中备选点中的极大值点为所需的峰值点，即所检测直线的参数(θ,ρ)。

5.4定位算子
数字影像上明显目标主要是指地面上明显地物在影像上的反映，或者是数字影像自身的明显标志，例如道路、河流的交叉口、田角、房角、建筑物上的明显标志、影像四角上的框标、地面人工标志点等等。
用于影像的定向，或者需要精确确定其位置。

1.Wong-Trinder圆点定位算子
利用二值图像的重心进行圆点定位。
首先，利用阈值T=（最小灰度值+平均灰度值）/2将窗口中的影像二值化为g_ij (i=0,1,…,n-1;j=0,1,…,m-1)，然后计算目标的重心坐标与圆度。当圆度小于阈值时，目标不是圆；否则圆心为重心坐标。
缺点与改进：误差较大，可达0.5像素，利用原始灰度为权，改进的算子在理想情况下可达0.01像素，但是这种算法只适合对圆点定位。

2.Forstner定位算子
对角点定位分最佳窗口选择与在最佳窗口内加权重心化两步进行。最佳窗口由Forstner特征提取算子确定。然后以原点到窗口内边缘直线的距离为观测值，梯度模的平方为权，在点(x,y)处可列误差方程
{█(v=x_0 cosθ+y_0 sinθ-(xcosθ+ycosθ)@ω(x,y)=|∇g|^2=g_x^2+g_y^2 )┤
由最小二乘法可解得角点坐标(x_0,y_0)，其结果即窗口内像元得加权重心。
优点：速度快，精度较高
缺点：定位精度仍不理想，当窗口为5×5个像素时，对理想条件下的角点定位精度仅为0.6个像素。

3.高精度角点与直线定位算子
（1）梯度算子的误差
由于用梯度方向代替直线方向存在不容忽视的模型误差，因而Hough变换等使用梯度方向的方法不可能达到很高的精度。
（2）数学模型
从微观上看，任何角点总是由两条直线构成的，通过精确的提取组成角的两条边缘直线，解算交点就可得到角点坐标。
该平差模型不采用梯度的方向，而是采用梯度的模为观测值，等权观测，迭代精确求解。
（3）初值
首先利用Hough变换确定直线参数初值ρ_0,θ_0。
（4）粗差的剔除
为了剔除观测值中的粗差，采用选权迭代法，使粗差在平差过程中自动地被逐渐剔除。
（5）窗口
精确定位窗口在粗定位矩形窗口中确定。
（6）角点定位
     当组成角点的两条直线被确定后，角点就是它们的交点。
（7）理论精度
     理论定位精度为0.02个像素。（n-4）
六、影像匹配基础理论与算法
摄影测量中双像（立体像对）的量测是提取物体三维信息的基础。
在数字摄影测量中是以影像匹配代替传统的人工观测，来达到自动确定同名像点的目的。
【彩色图像一般变为灰度再进行匹配（RGB三通道间存在相关性）】
匹配需要解决的问题：①匹配的手段：电子，光学，数字②相似性评价方法：测度（相关系数、特征……）③匹配的策略：误匹配处理，提高速度、可靠性，旋转不变性，尺度不变性④匹配的精度
6.1影像相关原理
1.影像相关：利用互相关函数，评价两块影像的相似性以确定同名点
2.基本原理：首先取出以待定点为中心的小区域中的影像信号，然后取出其在另一影像中相应区域的影像信号，计算两者的相关函数，以相关函数最大值对应的相应区域中心点为同名点。即以影像信号分布最相似的区域为同名区域，同名区域的中心点为同名点。
3.相关技术：电子相关（电子线路构成相关器）、光学相关（透镜的傅里叶光学）、数字相关（计算机作为相关器进行数值计算）
4.数字相关：利用计算机对数字影像进行数值计算的方式完成影像相关。
二维相关：二维相关时，一般在左影像上先确定一个待定点（点特征提取），称之为目标点，以此待定点为中心选取m*n（可相等）个像素的灰度阵列作为目标区或称目标窗口。为了在右影像上搜索同名点，必须估计出该同名点可能存在的范围，建立一个k*l个像素的灰度阵列作为搜索区，相关的过程就是依次在搜索区中取出m*n个像素灰度阵列（搜索窗口），计算其与目标区的相似性测度。当相似性测度取得最大值时，该搜索窗口的中心像素被认为是同名点。
一维相关：在核线影像上进行一维搜索。（一维相关的目标区和搜索区选取一般与二维相关相同，但搜索工作只在一个方向上进行）【二维相似性测度】
6.2影像相关的谱分析
1.维纳辛钦定理
随机信号的相关函数与其功率谱是一傅立叶变换对，即相关函数的傅立叶变换即功率谱，而功率谱的逆傅立叶变换即相关函数。
R_xy (τ)⇔S_xy (f)
2.影像功率谱的估计
	S(f)较平缓时，高频信息较丰富，纹理丰富；此时相关函数R(τ)较陡峭，相关精度高；但由可能的近似位置到正确相关的点间距离（称为拉入范围）较小。这就要通过低通滤波获得较大的拉入范围。此时出错概率大。因此搜索范围要小。 
	功率谱S(f)较陡峭，低频信息占优势，纹理平缓：因而相关函数R(τ)较平缓，相关精度较差，但拉入范围较大，相关结果出错的概率较小。因此可以大范围搜索。
3.金字塔影像相关（分频道相关）
对二维影像逐次进行低通滤波，并增大采样间隔，得到一个像元素总数逐渐变小的影像序列，将这些影像叠置起来颇像一座金字塔，因而称之为金字塔影像结构。
从粗到精的相关策略：先通过低通滤波，进行初相关，找到同名点的粗略位置，然后利用高频信息进行精确相关。（在模糊影像上，纹理（高频）少，大范围搜索也能保证出错率低，但有精度低的问题。因此将此搜索结果作为初值，一层一层的往塔底搜索，每次搜索位置扩大n个像素的范围，在底层影像上进行精确相关）
	金字塔影像的建立：每2×2=4个像元（或9像元平均等）平均为一个像元构成第二级影像，在第二级影像的基础上构成第三级影像。
	金字塔影像层的确定方法
将原始影像称为第零层，则第一层影像的每一像素相当于零层的(l*l)^1个像素，第k层影像的每一像素相当于零层的(l*l)^k个像素
	由影像匹配窗口大小确定金字塔影像层数 
w＜INT(n/l^k +0.5)＜lw
w，n是目标区和搜索区行列像元数中小者，k是金字塔层数，每l*l个像元合成一个像元，lk代表影像缩放倍数，INT(+0.5)代表四舍五入，等式左侧w代表不能缩小到小于目标窗口，等式右侧可根据情况变大。
	由先验视差确定金字塔影像层数
P_max=S*∆*l^k
P_max是最大左右视差，可通过航高，重叠度等估算，S是左右搜索距离（顶层金字塔左右搜索几个像素），Δ是像素大小（数码像片=1，胶片换算为mm）
4.影像匹配的步骤：
① 确定目标点
② 金字塔影像序列的生成
③ 以目标点为中心，建立目标窗口（目标区）
④ 在搜索影像上建立搜索区域
⑤ 在搜索区域中逐像素建立搜索区，与目标区进行相似性测度计算，得到p_ij
⑥ 取maxp_ij

6.3数字影像匹配基本算法
1.基于像方的影像匹配策略
常见的五种基本匹配算法：
	相关函数（矢量数积）	

其中，g(x,y)是左影像，g’(x,y)是右影像，p,q是相对于搜索区中心的偏差。
当 R(p0 , q0)＞ R(p, q) (pp0, qq0)，则p0，q0为搜索区影像相对于目标区影像的位移参数。对于一维相关应有q  0。
由于影像是离散的，因此有公式如下。

	协方差函数（矢量投影）

其中，E[g(x,y)]是左窗口灰度值求和取平均，E[g’(x+p,y+q)]是右窗口灰度值求和取平均。当两影像的灰度强度平均相差一个常量时，应用协方差测度可不受影响。
若C(p0 , q0)＞C(p, q)( pp0，qq0)，则p0 , q0为搜索区影像相对于目标区影像的位移参数。对于一维相关应有q  0。
	相关系数	（矢量夹角） 应用最广泛

灰度矢量经线性变换后相关系数是不变的
	差平方和（差矢量模）

	差绝对值和（差矢量分量绝对值和）


2.基于物方的影像匹配（铅垂线轨迹法VLL）
前提：已知内方位元素；已知定向参数；已知目标点的地面坐标（X,Y）
能够直接确定物体表面点空间三维坐标的影像匹配方法称为“地面元影像匹配”，也称基于物方的影像匹配。此时待定点的平面坐标(X,Y)是已知的，只需要确定其高程Z。
	铅垂线轨迹法（VLL-Vertical Line Locus）
原理：在物方有一条铅垂线轨迹，它在影像上的投影也是一直线。就是说VLL与地面交点A在影像上的构像必定位于相应的“投影差”上。因此，可以利用VLL法搜索其对应像点a1与a2从而确定A点的高程。
步骤：1. 给定地面点的平面坐标(X,Y)与近似最低高程Zmin。
      2. Zi＝Zmin＋i·Z 高程搜索步距Z可由所要求的高程精度确定
      3. 计算左右像坐标(xi’, yi’)与(xi’’ ,yi’’)

4. 分别以(xi’,yi’)与(xi”, yi”)为中心在左右影像上取影像窗口，计算其匹配测度，如相关系数pi。
5. 将i的值增加1，重复（2）（3）（4）三步，得到0，1，2，···n取其最大者k：
 k ＝ max{0，1，2，···n }
     6. 还可以利用k及其相邻的几个相关系数拟合一抛物线，以其极值对应的高程作为 A点的高程，以进一步提高精度，或以更小的高程步距在一小范围内重复以上过程。

3.影像匹配精度
影像匹配（相关）即使在定位到整像素的情况下，其理论精度也可达到大约0.3像素的精度。（这是由于像片是经过采样的离散矩阵）
用相关系数的抛物线拟合提高相关精度，可达到0.15～0.2子像素精度。把i点左右若干点处所求的相关系数值同一个平差函数联系起来，从而将其函数最大值k处作为寻求的同名点。

6.4最小二乘匹配
前提：已知目标点与匹配点的较为精确的初始位置
德国Ackermann教授提出了一种新的影像匹配方法——最小二乘影像匹配（least Squares Image Matching），影像匹配可以达到1/10甚至1/100像素的高精度。
优点：
• 最小二乘影像匹配中可以非常灵活地引入各种已知参数和条件（如控制点坐标），从而可以进行整体平差。可以实时解求。
• 解决“单点”的影像匹配问题，以求其“视差”；也可以直接解求其空间坐标
• 同时解决“多点”影像匹配或“多片”影像匹配
• 引入“粗差检测”，从而大大地提高影像匹配的可靠性
缺点：
当初始值不太准确时，系统的收敛性有待解决。
1.最小二乘影像匹配原理
影像存在系统误差，可分为辐射畸变和几何畸变。
辐射畸变： 
• 照明及被摄影物体辐射面的方向 
• 大气与摄影机物镜所产生的衰减 
• 摄影处理条件的差异以及影像数字化过程中所产生的误差等等
几何畸变
• 摄影机方位不同所产生的影像的透视畸变（摄影基线长/地面起伏大，变形大）
• 影像的各种畸变
• 由于地形坡度所产生的影像畸变等竖直航空摄影的情况下，地形高差则是几何畸变的主要因素
基本思想：在影像匹配中引入这些变形参数，同时按最小二乘的原则(vv＝min)，解求这些参数，就是最小二乘影像匹配的基本思想。
	仅仅认为影像灰度只存在偶然误差
n_1+g_1 (x,y)=n_2+g_2 (x,y)
误差方程：v=g_1 (x,y)-g_2 (x,y)
其中g1和g2代表左右影像，n1和n2代表随机噪声。
	仅考虑辐射的线性畸变的最小二乘匹配
n_1+g_1 (x,y)=h_0+h_1 g_2 (x,y)+g_2 (x,y)+n_2
误差方程：v=h_0+h_1 g_2-(g_1-g_2)
误差方程中有h1和h2两个参数，区域内每个像素都可以列一个误差方程。
求解（简略）：
v=Ax-l    A=[1  g_2 ]    x=[h_0   h_1 ]^T     l=g_1-g_2
平差求解可得h1和h2的表达式。
h_1=(∑▒g_1  ∑▒g_2 -n∑▒〖g_2 g_1 〗)/((∑▒g_2 )^2-n∑▒g_2^2 )-1           h_0=1/n[∑▒g_1 -∑▒g_2 -(∑▒g_2 ) h_1]
假定对g1，g2已作过中心化处理（求图像区域的均值(g_1 ) ̅/(g_2 ) ̅，每个像素减去均值）
则∑▒g_1 =0    ∑▒g_2 =0     h_0=1     h_1=(∑▒〖g_2 g_1 〗)/(∑▒g_2^2 )-1
消除了两个灰度分布的系统的辐射畸变后，其残余的灰度差的平方和为∑▒〖vv=〗 ∑▒g_1^2 -(∑▒〖g_2 g_1 〗)^2/(∑▒g_2^2 )
同时我们知道相关系数ρ^2=(∑▒〖g_2 g_1 〗)^2/(∑▒g_1^2  ∑▒g_2^2 )
因此相关系数和∑▒vv的关系为∑▒〖vv=〗 ∑▒g_1^2  (1-ρ^2 )   或写作(∑▒vv)/(∑▒g_1^2 )=1-ρ^2
式中∑▒vv是噪声的功率，∑▒g_1^2 是信号的功率，因此定义信噪比(SNR)2
(SNR)^2=(∑▒g_1^2 )/(∑▒vv)
相关系数与信噪比的关系(SNR)^2=1/(1-ρ^2 )  
以“相关系数最大”作为影像匹配搜索同名点的准则，其实质是搜索“信噪比为最大”的灰度序列。
影像匹配的主要目的是确定影像相对移位，传统的算法采用目标区相对于搜索区不断地移动一个整像素，搜索最大相关系数的影像区中心作为同名像点。在最小二乘影像匹配算法中，可引入几何变形参数，直接解算影像移位，这是此算法的特点。
	仅考虑影像相对移位的一维最小二乘匹配
假设两个一维灰度函数g1(x), g2(x),除随机噪声外，g2(x)相对于g1(x)只存在零次几何变形——移位量x。
n_1 (x)+g_1 (x,y)=g_2 (x+∆x,y)+n_2 (x)
误差方程：v(x)=g_2 (x+∆x,y)-g_1 (x,y)
为解求相对移位量x，需上式进行线性化
v(x)=g_2^' (x)*∆x-[g_1 (x)-g_2 (x)]
对离散的数字影像而言，灰度函数的导数g_2^' (x)可由差分代替。最终可以解得影像的相对移位x。
由此可知，最小二乘影像匹配是非线性系统，必须进行迭代。迭代过程收敛的速度取决于初值。
2.单点最小二乘影像匹配（一次匹配得到一对同名点单点）
两个二维影像之间的几何变形，不仅仅存在着相对移位还存在着图形变化。图形变化一般用仿射变换描述。
考虑图形变换的几何变形
x_2=a_0+a_1 x+a_2 y
y_2=b_0+b_1 x+b_2 y
灰度畸变+几何变形
n_1+g_1 (x,y)=h_0+h_1 g_2 (a_0+a_1 x+a_2 y,b_0+b_1 x+b_2 y)+n_2
基于此可以进行平差求解（此处略）
注：匹配的三大要点 匹配精度 可靠性 速度
最小二乘法影像匹配的迭代过程：
1. 几何变形改正。根据几何变形改正参数a0,a1,a2,b0,b1,b2将左方影像窗口的影像坐标变换至右方影像阵列：
x_2=a_0+a_1 x+a_2 y
y_2=b_0+b_1 x+b_2 y
2. 重采样。由于换算所得到的坐标x2，y2一般不可能是右方影像阵列中的整数行列号，因此重采样是必须的。由重采样获得g2(x2,y2)。一般来说，可以采用双线性内插进行重采样。
3. 辐射畸变改正。利用由最小二乘影像匹配所求得辐射畸变改正参数h0,h1。对上述重采样的结果作辐射改正。
4. 计算左方影像窗口与经过几何、辐射校正后的右方影像窗口之间的相关系数判断是否需要继续迭代。若相关系数小于前一次迭代后所求得的相关系数，则可认为迭代结束。也可以根据几何变形参数（特别是位移改正值）是否小于某个预定的阈值。
5. 采用最小二乘影像匹配，解求变形参数的改正值dh0 ,dh1 , da0 ,…。
6. 计算变形参数。
7. 计算最佳匹配的点位。影像匹配的目的是为了获得同名点。通常是以待定的目标点建立一个目标影像窗口，窗口的中心即为目标点。但是，在高精度影像相关中，必须考虑窗口的中心点是否是最佳匹配点。根据最小二乘来匹配的精度理论可知：匹配精度取决于影像灰度的梯度(g_x^2 ) ̇,(g_y^2 ) ̇。因此可用梯度的平方为权，在左方影像窗口内对坐标作加权平均：

以它作为目标点坐标，它的同名点坐标可由最小二乘影像匹配所求得的几何变换参数求得。

	最小二乘影像匹配的精度
常规的匹配算法，至多能获得一个影像匹配质量指标，如相关系数越大，影像匹配质量越好，但是无法获得其精度指标。利用最小二乘匹配算法，则可以根据σ_0以及法方程式系数矩阵的逆矩阵，同时获得其精度指标。

结论：影像匹配的精度与相关系数有关，相关系数愈大则精度愈高。它与影像窗口的“信噪比”有关，信噪比愈大，则匹配的精度愈高。影像匹配的精度还与影像的纹理结构有关，即与σ_g/σ_g ̇ 有关。特别是当σ_g ̇ （梯度值标准差）愈大，则影像匹配精度愈高。当σ_g ̇ =0时，即目标窗口内灰度没有变化时，则无法进行影像匹配。（因此要在左片上进行特征提取）
提高影像匹配精度的原因是引入了辐射畸变与几何畸变参数，对搜索影像进行了辐射和几何改正，从而提高了影像匹配的精度；

6.5特征匹配
1.灰度匹配：Area Based Image Matching在以待定点为中心的窗口(或称区域)内，以影像的灰度分布为影像匹配的基础，有时人们将它称为区域匹配。
2.特征匹配：Region Matching主要是用于配准影像的特征点、线或面。在特征匹配中，有时又被分为“低级特征匹配”( Low Level Feature Based Matching)和“高级特征匹配"( High Level Feature Based Matching)。 例如关系匹配就是属于高级特征匹配，它利用要素(特征)之间的关系进行匹配。
3.为什么需要特征匹配？
1）若待匹配的点位于低反差区内，即在该窗口内信息贫乏，信噪比很小，则其匹配的成功率不高。
2）另外，在很多应用场合，影像匹配不一定用于地形测绘目的，也不一定要生成密集的DEM(或DSM)网格点（如机器人视觉），它无需产生密集的描述空间物体的网格点，而只需要配准某些“感兴趣”的点、线或面。
3）即使在大比例尺城市航空摄影测量中，被处理的对象主要是人工建筑物，而非地形，这时由于影像的不连续、阴影与被遮蔽等原因，基于灰度匹配的算法也难以适应。
4）因此，在很多场合，影像匹配主要是用于配准那些特征点、线或面。为有别于前述的基于灰度的匹配，这一类算法被称为特征匹配或基于特征的匹配(Feature Based Matching，在计算机界也称为Primitive Based Matching)。
2.基于特征点的影像匹配策略
（1）特征提取
	根据各特征点的兴趣值将特征点分成几个等级。
	对不同的目的，特征点的提取应有所不同。（相对定向，空三，少量分布均匀特征点；生成DEM, DSM则需要密集匹配）
	特征点的分布可以有两种方式
随机分布：按顺序进行特征提取，但控制特征的密度。
均匀分布：将影像划分成规则矩形格网，每一格网内提取特征点。
（2）特征提取
	二维匹配与一维匹配：影像方位参数未知时，必须进行二维影像匹配；此时匹配的主要目的是利用明显点对解求影像的方位参数，以建立立体影像模型，形成核线影像进行一维匹配。
注：一维匹配时也要在核线上下一、两行搜索，因为重采样、方位元素等过程存在误差。
	匹配的备选点选择方法 
1) 对右影像也进行相应特征提取 
2) 右影像不进行特征提取（逐像素搜索）
3) 右影像不进行特征提取，但也不将所有的点作为可能的匹配点（依靠先验知识）
（3）特征点的提取与匹配的顺序：深度优先or广度优先。摄测中多使用广度优先的匹配顺序，即先匹配一整层再匹配下一层。
（4）匹配的准则：除了运用一定的相似性测度，一般还可考虑特征的方向，周围已匹配点的结果。
（5）粗差的剔除：小范围内利用倾斜平面模型进行视差拟合，将残差大于某一阈值点作为粗差剔除。

3.跨接法影像匹配
先进行几何改正，再影像匹配。抗变形能力强，在基线长、地形起伏大的地方适用。
处理影像几何变形的两种方式 
1) 先不顾及几何变形作 “粗匹配 ”，然后用其结果作几何改正再匹配。
2) 最小二乘影像匹配将影像匹配与几何改正均作为参数同时解算。
跨接法影像匹配步骤
1. 特征提取（特征定义为一个“影像段”，由三个特征点组成：一个灰度梯度最大点Z，两个“突出点”（梯度很小）S1，S2）
2. 构成跨接法匹配窗口 （将两个特征连接起来构成窗口）
3. 跨接法影像匹配


4.SIFT算子（尺度不变特征变换）
David G.Lowe在2004年总结了现有的基于不变量技术的特征检测方法，并正式提出了一种基于尺度空间的、对图像缩放、旋转甚至仿射变换保持不变性的图像局部特征描述算子－SIFT算子，其全称是Scale Invariant Feature Transform，即尺度不变特征变换。
特点
	SIFT特征是图像的局部特征，其对旋转、尺度缩放、亮度变化保持不变性，对视角变化、仿射变换、噪声也保持一定程度的稳定性。
	独特性(Distinctiveness)好，信息量丰富，适用在海量特征数据库中进行快速、准确的匹配。（适用于模式识别）
	多量性，即使少数的几个物体也可以产生大量SIFT特征向量
	高速性，经优化的SIFT匹配算法甚至可以达到实时的要求。
	可扩展性
特征匹配是特征参数的影像匹配方法，不需要已知影像间的关系；特征匹配解决的摄影测量中影像匹配的初值问题；
步骤
	尺度空间极值探测：首先在尺度空间进行特征检测，用极值探测的方法确定关键点的位置和关键点所处的尺度，使用关键点邻域梯度的主方向作为该点的方向特征，以实现算子对尺度和方向的无关性；引入尺度参数，用高斯卷积核实现尺度变换；DoG算子定义为两个不同尺度的高斯核的差分；将相邻高斯金字塔影像相减，生成高斯金字塔影像差分金字塔影像； 
	关键点精确定位：通过拟和三维二次函数以精确确定关键点的位置和尺度。
	确定关键点的主方向：利用关键点邻域像素的梯度方向分布特性为每个关键点指定方向参数，使算子具备旋转不变性。
	关键点的描述：一个关键点可以产生128个数据，最终形成128维的SIFT特征向量。
	特征匹配：左右影像都要提取特征，然后进行匹配。采用关键点特征向量的欧式距离来作为两幅图像中关键点的相似性判定度量，距离最小即为匹配点。
七、数字地面模型的建立与应用
7.1概述
DTM数字地面模型：DTM是定义在某一区域D上的m维向量有限序列：{V_i,i=1,2,…,n}，其向量V_i=(V_i1,V_i2,…,V_in)的分量为地形(X_i,Y_i,Z_i)((X_i,Y_i)∈D)、资源、环境、土地利用、人口分布等多种信息的定量或定性描述。
DTM是一个地理信息数据库的基本内核。

DHM/DEM数字高程模型：若只考虑DTM的地形分量，我们通常称其为数字高程模型DEM（Digital Elevation Model）或DHM（Digital Elevation Model），其定义如下：
数字高程模型DEM是表示区域D上地形的三维向量有限序列{V_i=(X_i,Y_i,Z_i ),i=1,2,…,n}，其中(X_i,Y_i)∈D是平面坐标，Z_i是(X_i,Y_i)对应的高程。当该序列中各向量的平面点位是规则格网排列时，则其平面坐标(X ,Y.)可省略此时DEM就简化为一维向量序列{Z_i,i=1,2,…,n}，这也是DEM或DHM名称的缘由。
DEM的表现形式：
（1）规则矩形格网Grid
利用一系列在X，Y方向上都是等间隔排列的地形点的高程Z表示地形，形成一个矩形格网DEM。其任意一个点P_ij的平面坐标可根据该点在DEM中的行列号j,i及存放在该文件头部的基本信息推算出来。这些基本信息应包括DEM起始点（一般为左下角）坐标X_0,Y_0。DEM格网在X方向与Y方向的间隔DX，DY及DEM的行列数NY，NX等。
优点：存贮量最小，非常便于使用且容易管理，因而是目前运用最广泛的一种形式。
缺点：有时不能准确的表示地形的结构与细部，因此基于DEM描绘的等高线不能准确地表示地貌。

（2）不规则三角网TIN
将按地形特征采集地点按一定规则连接成覆盖整个区域且互不重叠地许多三角形，可构成一个不规则三角网。
优点：TIN能较好地顾及地貌特征点、线，表示复杂地形表面比矩形格网（Grid）精确。
缺点：数据量较大，数据结构较复杂，因而使用与管理也较复杂
（3）Grid-TIN
一般地区使用矩形网数据结构（还可以根据地形采用不同密度的格网），沿地形特征附加三角网数据结构。充分利用了以上两种模型的优点。

DOM数字正射影像/数字物体模型
DSM数字表面模型：是指包含了地表建筑物、桥梁和树木等高度的地面高程模型。和DEM相比，DEM只包含了地形的高程信息，并未包含其它地表信息，DSM是在DEM的基础上，进一步涵盖了除地面以外的其它地表信息的高程。DSM表示的是最真实地表达地面起伏情况，可广泛应用于各行各业。
DBM数字建筑模型
DLG数字线划图
7.2数字高程模型的数据获取及预处理
1.DEM数据点的量测方法
（1）地面测量
利用自动记录的测距经纬仪(常称为电子速测经纬仪或全站经纬仪)在野外实测。这种速测经纬仪一般都有微处理器，它可以自动记录与显示有关数据，还能进行多种测站上的计算工作。其记录的数据可以通过串行通讯等方式，输人其他计算机（如PC机）进行处理。
（2）现有地图数字化
这是利用数字化仪对已有地图上的信息(如等高线、地形线等)进行数字化的方法。目前常用的数字化仪有手扶跟踪数字化仪与扫描数字化仪。
	手扶跟踪数字化仪
	扫描数字化仪
（3）空间传感器
利用GPS( Global Positioning System)、雷达和激光测高仪(如LIDAR: Light Detection and Ranging )等进行数据采集。
（4）数字摄影测量方法
这是DEM数据点采集最常用的一种方法。利用附有自动记录装置(接口)的立体测图仪或立体坐标仪、解析测图仪及数字摄影测量系统，进行人工、半自动或全自动的量测来获取数据。

2.数字摄影测量的DEM数据采集方式
（1）沿等高线采样
在地形复杂及陡峭地区，可采用沿等高线跟踪的方式进行数据采集，而在平坦地区，则不易采用沿等高线的采样，沿等高线采样可按等距离间隔记录数据或按等时间间隔记录数据方式进行。
（2）规则格网采样
利用解析测图仪在立体模型中按规则矩形格网进行采样，直接构成规则格网DEM。
（3）沿断面扫描
利用解析测图仪或附有自动记录装置的立体测图仪对立体模型进行断面扫描，按等距离方式或等时间方式记录断面上点的坐标。
（4）渐进采样
为了使采样点分布合理，即平坦地区样点较少，地形复杂地区的样点较多，可采用渐近采样的方法。先按预定的比较稀疏的间隔进行采样，获得一个较稀疏的格网，然后分析是否需要对格网加密。判断方法可利用高程的二阶差分是否超过给定的阈值；或利用相邻三点拟合一条二次曲线，计算两点间中点的二次内插值与线性内插值之差，判断该差值是否超过给定的阈值。
当超过阈值时，则对格网进行加密采样，然后对较密的格网进行同样的判断处理，直至不再超限或达到预先给定的加密次数（或最小格网间隔），然后再对其他格网进行同样的处理。
（5）选择采样
为了准确地反映地形，可根据地形特征进行选择采样，例如，沿山脊线、山谷线、断裂线进行采集以及离散碎部点（如山顶）的采集。
（6）混合采样
为了同时考虑采样的效率与合理性，可将规则采样(包括渐近采样)与选择采样结合起来，即在规则采样的基础上再进行沿特征点、线的采样。
（7）自动化DEM数据采集
按照影像上的规则格网利用数字影像匹配进行数据采集。
基于像方的自动影像匹配处理流程：生成核线影像对，并生成金字塔序列影像对；在原始影像上提取密集特征点/特征线；基于特征点影像匹配策略，获得匹配点；将自动量测的同名像点前方交会，计算其物方坐标，得到三维点云；
根据格网DEM的平面坐标逐点按基于物方的影像匹配算法，匹配获得格网DEM上每个格网点上的高程值。
数据特点 
• 数据点多为密集的地形数据点； 
• 包括地形的特征数据，如地形中的最高/最低点、地形线、断裂线等； 
• 数据中包含大量的误匹配数据点；
3.DEM质量控制
数据采集是DEM的关键问题。内插方法不能弥补取样不当造成信息损失。
DEM的质量控制：插值分析法、由采样定理确定采样间隔、由地形剖面恢复误差确定采样间隔
4.DEM数据预处理
包括数据格式的变换、坐标系统的变换、数据的编辑、栅格数据的矢量化转换及数据分块等内容。
数据分块：内插DEM时，待定点只与周围数据点有关，为了能在大量的数据点中迅速查找所需要的数据点，必须将其分块。
（1）交换法：将数据点按分块格网的顺序进行交换，使属于同一分块格网的数据点连续地存放在一片连续的存储区域中，同时建立一个索引文件，记录每一块（分块格网）数据的第一点在数据文件中的序号。该方法不需要增加存储量，但数据交换需要花费较多的计算机处理时间。
（2）链指针法：对于每一个数据点，增加一个存贮单元（链指针），存放属于同一个分块格网中下一个点在数据文件中的序号。
7.3数字高程模型的内插方法
DEM内插就是根据参考点上的高程求出其他待定点上的高程，在数学上属于插值问题。
注意：这是获取DEM的间接方法
1.移动曲面拟合法
不止二次曲面一种形式，可以是多个邻近点的加权平均水平面移动拟合法内插、平面移动拟合内插法等等
（1）对DEM每一个格网点，从数据点中检索出对应该DEM格网点的几个分块格网中的数据点，并将坐标原点移至该DEM格网点P(X_P,Y_P)
（2）为了选取邻近的数据点，以待定点P为圆心，以R为半径作圆，凡落在圆内的数据点即被采用。所选择的点数由所选择的局部拟合函数来决定，在二次曲面内插时，要求选用的数据点个数大于6。当数据点P(X,Y)到待定点P(X_P,Y_P)的距离小于R时，该点即被采用。若选择的点数不够，则应增大R的数值，直至点数满足要求。
（3）列出误差方程式
（4）计算每个数据点的权，与距离成反比，反映了该点与待定点相关的程度，形式可根据地形实验选取。
（5）法化求解。X=(M^T PM)^(-1) M^T PZ
注意事项
对点的选择除满足n＞6外，应保证各个象限都有数据点。
当地形起伏较大时，半径R不能取得很大。 
当数据点较稀或分布不均匀时，利用二次曲面移动拟合可能产生很大的误差。

2.多面函数法DEM内插
从几何观点出发，解决根据数据点形成一个平差的数学曲面问题。
理论根据：任何一个圆滑的数学表面总是可以用一系列有规则地数学表面的总和，以任意精度进行逼近。
即利用一系列核函数去逼近地形，计算误差，法化求解等等。
一个数学表面上某点（X,Y）处高程Z的表达式为
Z=f(X,Y)=∑_(j=1)^n▒〖a_j q(X,Y,X_j,Y_j)〗
q(X,Y,X_j,Y_j )=√((X-X_i )^2+(Y-Y_i )^2+δ)
其中q(X,Y,Xj,Yj)为核函数，(Xj, Yj)是已知点，也称核函数中心。δ用作非0处理。每个已知点可以列一个误差方程，但不能把所有已知点都选做核函数中心，否则就没有多余观测了。
	适合采样数据较少时使用，适合小区域以及较平坦地区的DEM生成。

3.有限元法DEM内插
为了解算一个函数，有时需要把它分成为许多适当大小的单元，在每个单元中用一个简单的函数，例如，用多项式来近似地代表它。对于曲面，也可以用大量的有限面积单元来趋近它，这就是有限元法。
	一次样条有限元DEM内插
	断裂线的处理
	在原有数据点的基础上作线性内插，突出断裂线特征。
	按断裂线划分子区。
	分子区内插（不属于该子区的数据点不参加该子区平差计算）（判断数据点是否属于该子区：跌落法/符号判断法）
在对地形断裂区域的处理方面更有优势。
三种方法总结：移动曲面法对于密集点云的处理非常有效; 多面函数法是一种整体DEM插值方法，对采样数据点少时，比较实用；有限元DEM内插可以对地形断裂的区域。
7.4DEM的精度及存贮管理
规则格网DEM精度：数据获取（数据本身精度）+数据内插（内插手段）
1.估计DEM精度的方法
	由地形功率谱与内插方法的传递函数估计DEM 精度
结论：DEM精度主要取决于采样间隔和地形复杂程度，不同的内插方法精度差别不大。
	利用检查点的DEM精度评定
在DEM内插时，预留一部分数据点不参加DEM内插，作为检查点，其高程为Zk（k=1，2，…，n）。在建立DEM之后，由 DEM内插出这些点的高程为，则 DEM的精度为：
σ_DEM^2=1/n ∑_(k=1)^n▒((Z_k ) ̅-Z_k )^2 
2.DEM的存贮管理
1) DEM数据文件的存贮 
• 文件头+各格网点的高程   • 通用影像格式，eg. TIFF    • 其它文件格式
2) 地形数据库 
将整个范围划分成若干地区，每一地区建立一个子库， 将这些地区合并成一个高一层次的大区域构成整个范围的数据库
3) DEM数据的压缩 
	DEM数据压缩中的常用方法有整型量存贮、差分映射和压缩编码。
	整型量存贮：将高程数据减去一常数Z0，m为原始数据小数点位数。变换为整型后，每个数只用两个字节（原来是浮点数，4个字节）
	Z_i=INT[(Z_i-Z_0 )*〖10〗^m+0.5]
	差分映射：存储相邻数据间的增量，数据范围较小，可以利用一个字节存贮一个数据，使数据压缩至原有存贮量的近四分之一。
	差分游程法：当差分的绝对值大于127时，将该数据之前的数据作为一个游程，而从该项数据开始一新的游程。很高的压缩率，但其缺点是当游程较长时，数据的恢复需要较多的运算时间。
	小模块差分法：将DEM分成较大的格网——小模块，每一模块包含5*5或10*10个DEM格网，将数据点按下图顺序排列，进行差分映射。为了保证每一数据能存入一个字节，在原始差分上乘以一个适当的系数。

优点是每一记录长度是固定的，每一记录与各个小模块联系是确定不变的。
	压缩编码：当根据各数出现的概率设计一定的编码，用位数（bit）最短的码表示出现概率最大的数，出现概率较小数用位数较长的码表示，则每一数据所占的平均位数比原来的固定位数（16或8）小。
4) DEM的管理
	• 若DEM以图幅为单位存贮，每一存贮单位可能由多个模型拼接而成，因而要建立一套管理软件，以完成DEM按图幅为单位的存贮、接边及更新工作。
	• 用户只能读取的，而不能写入，只有DEM维护管理人员才有权写入。
	• 对每一图幅可建立一管理数据文件，记录每一DEM格网或小模块的数据录入状况，使操作人员可清楚、直观地观察到该图幅DEM数据录入情况
	• 接边：取其平均值，也可按距离进行加权平均。
	7.5三角网数字地面模型
	1.三角网数字地面模型的构建
	所有点都是原始获取，不需要插值。
	可以建立各种非规则网的DEM，最简单是不规则三角网（TIN，Triangulated Irregular Network）。不规则三角网(TIN)可表达地形的细节，可根据采集的地形特征数据表达不同的地形类别。应尽可能保证每个三角形是锐角三角形或三边的长度近似相等，避免出现过大的钝角和过小的锐角。
	采样数据类型
	高程点：已知其平面坐标(X,Y,Z)；
	地形线：山脊线、山谷线、地形变化线(通常为具有三维坐标的多点折线)；
	断裂线：陡坎线、地形断裂线；
	水涯线：河流、湖泊等边界线；
	等高线等；
	构建不规则三角网(TIN)的方法
	角度判断法建立TIN：当已知三角形的两个顶点后，利用余弦定理计算备选第三顶点的三角形内角的大小，选择最大者对应的点为该三角形的第三顶点。
1) 将原始数据分块：检索所处理三角形邻近点。
2) 确定第一个三角形。
3) 三角形的扩展：对每一个已生成的三角形的新增加的两边，按角度最大的原则向外进行扩展，并进行是否重复的检测。
	注：B是离A最近的一点，最短的边对最大的角，保证是锐角三角形。确定第一个三角形后从新产生的边向外扩展，扩展时不能交叉，重复，要做异侧检测F(X,Y)*F(X_3,Y_3 )<0

	泰森多边形与狄洛尼三角网

泰森多边形的分法是唯一的。
每个泰森多边形均是凸多边形；任意两个泰森多边形不存在公共区域。
狄洛尼三角网在均匀分布点的情况下，可避免产生狭长和过小锐角三角形。
利用数学形态学可建立泰森多边形与狄洛三角网
2.三角网数字地面模型的存贮
与格网型DEM不同，TIN不仅要存储高程，还要存贮平面坐标、网点连接的拓扑关系、三角形及邻接关系三角形等信息。常用的三种存贮方法如下。
	直接表示网点邻接关系的结构

	直接表示三角形及邻接关系的结构
	 
	混合表示网点及三角形邻接关系的结构

TIN的压缩存贮：可将TIN转化为规则三角网存贮方式，从而实现TIN的压缩存贮。
3.不规则三角网DEM中的内插
（1）格网点的检索：确定P点落在哪个三角形内

（2）三角形中的内插：P点必位于三角形平面内，满足共面条件

（3）基于TIN内插的应用——任意断面的生成
给定一条任意方向的断面线的直线方程确定断面线的起点和终点沿断面线方向按一定采样间隔𝑡=𝑖 ∙ ∆𝑡 获取断面上的平面坐标逐点按TIN内插方法插值计算 𝑋𝑡 , 𝑌𝑡 的高程𝑍
4.基于三角网的等高线绘制
7.6数字地面模型的应用
数字地面模型在测绘中可用于绘制等高线、坡度、坡向图、立体透视图，制作正射影像图、立体景观图、立体匹配片、立体地形模型及地图的修测。在各种工程中可用于体积、面积的计算，各种剖面图的绘制及线路的设计。
1.基于矩形格网的DEM多项式内插
DEM最基础的应是求DEM范围内任意一点P(X,Y)的高程。
（1）双线性多项式(双曲抛物面)内插：根据最邻近的4个数据点确定一个双线性多项式。双线性多项式内插只能保证相邻区域接边处的连续，不能保证光滑。但因其计算量较小,是最常用的方法
（2）双三次多项式(三次曲面)内插：取最邻近的16个数据点进行插值。可以保证相邻曲面之间的连续与光滑。
2.基于格网型DEM的等高线的绘制
分为等高线跟踪和等高线光滑两个部分。
	等高线跟踪
1) 确定等高线高程 

其中z是等高线上点高程，Zmin, Zmax是DEM中最低/最高的点。满足最高的点不低于最高等高线，最低的点不高于最低等高线。
2) 计算状态矩阵：H和V表示等高线穿过DEM格网水平边与竖直边的状态，1代表穿过，0代表没有穿过。

3) 等高线的起点和终点的处理：与边界相交的等高线为开曲线，不与边界相交的等高线为闭曲线
处理好（插值）的点状态矩阵的值从1变0，闭曲线的起点处理完后还为1，所有点都变为0说明等高线处理完了。
4) 内插等高线点：等高线点的坐标一般采用线性内插。

5) 搜索下一个等高线点

	等高线光滑（曲线内插）
• 曲线应通过已知的等高线点（称为节点） 
• 曲线在节点处光滑，即其一阶导数（或二阶导数）是连续的 
• 相邻两个节点间的曲线没有多余的摆动； 
• 同一等高线自身不能相交。
3.立体透视图
4.DEM的其他应用
单像修测：由于地图修测的主要内容是地物的增减，因而利用已有的DEM可进行单幅影像的修测，这样可节省资金与工时。（单像修测算法为迭代算法，在特殊情况下不收敛）

八、数字微分纠正
8.1数字微分纠正的概念
根据有关的参数与数字地面模型，利用相应的构像方程，或按一定的数学模型用控制点解算，从原始非正射投影的数字影像获取正射影像，这种过程是将影像化为很多微小的区域逐一进行纠正，且使用的是数字方式进行处理，故叫数字微分纠正或数字纠正。
能否真正做到点元素微分纠正，取决于能否真实的测定每个像元的物方坐标X，Y，Z。
基本原理：
数字微分纠正与光学微分纠正一样，其基本任务是实现两个二维图像之间的几何变换。因此与光学微分纠正的基本原理一样，在数字微分纠正过程中，必须首先确定原始图像与纠正后的图像之间的几何关系。设任一像元在原始图像和纠正后图像中的坐标分别为(x,y)和(X,Y)。它们之间存在映射关系：
x=f_x (X,Y);y=f_y (X,Y)（8-1）
X=φ_x (x,y);Y=φ_y (x,y)（8-2）
公式8-1是由纠正后的像点坐标(X,Y)出发反求其在原始图像上的像点坐标(x,y)，这种方法称为反解法（或称为间接解法）。而公式（8-2）则相反，它是由原始图像上像点坐标(x,y)解求纠正后图像上相应点坐标(X,Y)，这种方法称为正解法（或称为直接解法）。
8.2框幅式中心投影影像的数字微分纠正
1.反解法
1) 计算地面点坐标（正射影像范围、分辨率需已知）
X=X_0+M*X^'
Y=Y_0+M*Y^'
(X,Y)为地面点坐标，M是比例尺，(X’,Y’)是正射影像上任意一点，(X0,Y0)是左下角图廓点地面坐标。
2) 由DEM内插高程, 计算像点坐标：由DEM内插出(X,Y)处的高程，用共线方程求得x,y。由于数字化影像是以行列计量的，因此要通过数字内定向由x,y求i,j。
3) 灰度内插：由于所求得的像点坐标不一定正好落在像元素中心，为此必须进行灰度内播，一般可采用双线性内插方法，求得像点P的灰度值g(x, y)。
4) 灰度赋值：将像点P的灰度值赋给纠正后像元素P
5) 重复1)~4)逐像素纠正为正射影像
注：要已知内外方位元素、比例尺、内定向转换参数
2.正解法
从原始图像出发，将原始图像上逐个像元素用正解公式求得纠正后的像点坐标。
缺点：在纠正后的图像上，所得的像点是非规则排列的，有的像元素内可能出现“空白”，而有的像元素内可能出现重复多个像点，因此很难实现灰度内插并获得规则排列的数字影像。
此外由于正算公式中Z的存在，需要假定一近似值，因此必须是一个迭代的计算过程。
3.实际解法及分析
在数字微分纠正的实际软件系统中，是按“面元素”做纠正单元的，而在纠正单元中，无论沿x方向还是y方向均由线性内插解求。因此，它与数控光学正射投影仪上以线元素为单元作线性缩放无本质区别，而是完全一致的。
8.3线性阵列扫描影像的数字微分纠正
框幅式每个像点外方位元素都是一样的，而线阵推扫会变，不同扫描线外方位元素不同（不同扫描时刻外方位元素不同），若干条扫描线形成一幅影像。
	像方坐标到物方坐标正算

	像方坐标到物方坐标反算
由已知的地面点（X，Y，Z）计算其在CCD线阵影像上构像点的扫描坐标（I，J，t（J））
1. 按照地面坐标Y和线阵CCD影像的地面分辨率GSD计算摄影时刻t的近似值t≈(Y-Y_S0)/GSD YS0是t=0时刻的摄站Y坐标。
2. 采用线性内插方法获得t时刻的外方位元素。
3. 按照构像方程计算像片坐标。
4. 判断迭代收敛条件，如果收敛终止迭代；反之修改摄影时刻，返回步骤2继续迭代。

1.间接法纠正
按泰勒级数展开后，取至二次项得：
t=-[(Xa_2^((0) )+Yb_2^((0) )+Zc_2^((0) )-A^((0) ) )+Xa22+Yb22+Zc22-A2t2](Xa21+Yb21+Zc21-A1)
上式右端含有t^2项，所以对t必须进行迭代计算。t值实际上表达了在线性扫描影像坐标系中像点p在时刻t的y坐标
2.直接法纠正
当给定高程初始值Z0后，带入式子可以得到地面平面坐标近似值（X1，Y1），再用DEM与（X1，Y1）内插出其对应的高程Z1。重复上述过程，直至收敛到（x，y）对应的地面点（X，Y，Z），其过程与框幅式中心投影影像的正解法相同。当地面坡度较大而不收敛时，可按单片修测中的方法处理。
3.直接法与间接法相结合的方案
对于线性阵列传感器影像的纠正，由于利用间接法也需要迭代求解，而直接法本来就需要迭代求解，因而可以将两种方法结合起来。
首先在影像上确定一个规则格网，其所有格网点的行、列坐标显然是已知的，其间隔按像元的地面分辨率换算后与数字高程模型DEM的间隔一致，用直接法解算它们的地面坐标，再按间接法进行修正。
（1）影像规则格网点对应的地面坐标的解算
利用公式按直接法进行解算，得到地面一非规则格网，它们的地面坐标与对应的影像坐标均为已知。
（2）地面规则格网对应的像点坐标的内插
利用相邻四点的影像坐标与地面坐标作拟合，最后带入地面坐标计算其影像坐标。
4.多项式纠正
是一种平面到平面的纠正，利用多项式逼近的基本思想是认为影像变形规律可近似地看做平移、缩放、旋转、仿射、偏扭、弯曲等基本形变地合成。
在选用时往往是根据可能提供的控制点数来决定多项式的阶数。为了减少由于控制点选得不准确所产生的不良后果，往往要求有较多的多余控制点数。
为了减小由于控制点位分布不均匀
8.4立体正射影像对的制作
1.基本思想
正射影像既有正确的平面位置，又保持着丰富的影像信息，这是它的优点。但是，它的缺点是不包含第三维信息。
正射影像和相应的立体匹配片共同称为立体正射影像对。
立体正射影像的基础是数字高程模型(DEM)。为了获得正射影像，必须将DEM格网点的X、Y、Z坐标用中心投影共线方程变换到影像上去。
如果要获得立体效应，就需要引人一个具有人工视差的匹配片。该人工视差的大小应能反映实地的地形起伏情况。最简单的方法是利用投射角为a的平行光线法。此时，人造左右视差将直接反映实地高差的变化。
2.立体正射影像对的制作方法（斜平行投影法）

3.适合高程量测的立体正射影像对制作（对数投影法）

九、数字测图（计算机辅助测图）
计算机辅助测图是在计算机的辅助下，完成除了人工立体观测值之外的其它大部分操作，包括数据采集、数据处理、形成数字地面模型与数字地图并存入磁带、磁盘或光盘中。